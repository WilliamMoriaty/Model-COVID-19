fig1=figure(1)
clf();
set(gcf,'position',[30,50,1480,720])
n=200;N=5000;n1=1;
cor=[0.5 0.5 0.5];
load('K1_47.mat')
fig1=figure(1)
% path='Heter_seed/output/';
% [Y2 Y3 Y4 Y8 t]=output(path,n);
Y2=Virus;Y3=Cytokine;Y4=TCells;Y8=NumberInf;
t=0:0.01:720;

axes('position',[0.187,0.62,0.277,0.366]);
for i=1:n1:n
plot(t/24,Y8(:,i)/N,'linewidth',1.0,'color',cor(1,:));
hold on
end
plot([0 30],[0.05 0.05],'k--','linewidth',1.5)
annotation(fig1,'textbox',...
    [0.289791934791936 0.952222222222223 0.0896825396825411 0.0397317878671301],...
    'Color',[1 0 0],...
    'String','Symptomatic',...
    'FontWeight','bold',...
    'fontname','Helvetica',...
    'FontSize',14,...
    'FontAngle','italic',...
    'FitBoxToText','off',...
    'EdgeColor','none');
annotation(fig1,'doublearrow',[0.382 0.382],...
    [0.981 0.672],'Color',[1 0 0],'LineWidth',1.5,...
    'LineStyle','--',...
    'Head2Length',2,...
    'Head1Length',2);
annotation(fig1,'doublearrow',[0.382 0.382],...
    [0.665 0.623],'Color',[0 0 1],'LineWidth',1.5,...
    'LineStyle','--',...
    'Head2Length',2,...
    'Head1Length',2);
annotation(fig1,'textbox',...
    [0.284339472908349 0.627500000000002 0.0952551216862466 0.0503490124406881],...
    'Color',[0 0 1],...
    'String','Asymptomatic',...
    'FontWeight','bold',...
    'fontname','Helvetica',...
    'FontSize',14,...
    'FitBoxToText','off',...
    'EdgeColor','none');
xlabel('day after infection','FontName','Helvetica','FontSize',10,'FontWeight','bold')
ylim([0 0.4])
ylabel('R_{IC}','FontName','Helvetica','FontSize',10,'FontWeight','bold')
set(gca,'ytick',0:0.1:0.4)
set(gca,'FontName','Helvetica','FontSize',10,'FontWeight','bold','linewidth',1.2)
box off

axes('position',[0.557,0.62,0.277,0.366]);
n=200;
load('Incubationdata.mat')
% load('K1_50.mat')
x=0:1:30;
% [u,x]=hist(Inc,x);
[u1,x]=hist(Incubation,x);
% plot(x,100*(cumsum(u)/n),'k.','markersize',18,'linestyle','-');
% hold on
load('K1_47.mat')
Inc_47=Inc(1,find(Inc<30));
[u2,x]=hist(Inc_47,x);
n1=sum(u2);
plot(x,100*(cumsum(u2)/n),'k','linestyle','-','linewidth',1.2);
hold on
% load('K1_45.mat')
% Inc_45=Inc(1,find(Inc<30));
% [u2,x]=hist(Inc_45,x);
% plot(x,100*(cumsum(u2)/n),'r.','markersize',18,'linestyle','-');
% hold on
plot(x,100*(cumsum(u1)/size(Incubation,1)),'markersize',8,'marker','o'...
    ,'markerfacecolor',[0.91,0.57,0.13],'markeredgecolor','k','linestyle','none')
% legend('K_1=50','K_1=45','Real-data','location','best')
leg=legend('Simu.','Dataset1','location','best','autoupdate','off');
leg.ItemTokenSize = [10,5];
legend('box','off')
xlabel('Incubation period (T_{IP})','FontName','Helvetica','FontSize',10,'FontWeight','bold')
ylabel('Cumulative probability (%)','FontName','Helvetica','FontSize',10,'FontWeight','bold')

set(gca,'ytick',0:20:100)
set(gca,'FontName','Helvetica','FontSize',10,'FontWeight','bold','linewidth',1.2)


box off

t1=1:1:720;t2=0:1:720;
S_Inf_m=[];S_Clear_m=[];
k=find(Inc>=15&Inc<30);
n=81;
for i=1:720
sum_Inf=0;sum_Clear=0;
for j=100*i-98:100*i+1
sum_Inf=sum_Inf+InfNum(j,n);
sum_Clear=sum_Clear+ClearNum(j,n);
end
S_Inf_m=[S_Inf_m sum_Inf];
S_Clear_m=[S_Clear_m sum_Clear];
end

a=find(Inc==30);S_Inf_as=[];S_Clear_as=[];
m=169;
for i=1:720
sum_Inf=0;sum_Clear=0;
for j=100*i-98:100*i+1
sum_Inf=sum_Inf+InfNum(j,m);
sum_Clear=sum_Clear+ClearNum(j,m);
end
S_Inf_as=[S_Inf_as sum_Inf];
S_Clear_as=[S_Clear_as sum_Clear];
end

t=0:0.01:720;

axes('position',[0.187,0.30,0.173,0.194]);

plot(t/24,NumberInf(:,n)/N,'color','r','linewidth',1.2)
hold on
plot(t/24,NumberInf(:,m)/N,'color','b','linewidth',1.2)
hold on
plot([0 30],[0.05 0.05],'color','k','linewidth',1.2,'linestyle','--')
ylabel('R_{IC}','FontName','Helvetica','FontSize',10,'FontWeight','bold')
set(gca,'xticklabel',{})
set(gca,'FontName','Helvetica','FontSize',10,'FontWeight','bold','linewidth',1.2)
% title('( i )','FontName','Helvetica','FontSize',15,'FontWeight','bold')
leg=legend('Symp.','Asymp.','location','best','autoupdate','off');
leg.ItemTokenSize = [10,5];
legend('box','off')
box off

axes('position',[0.419,0.30,0.173,0.194]);

plot(t/24,Virus(:,n),'color','r','linewidth',1.2)
hold on
plot(t/24,Virus(:,m),'color','b','linewidth',1.2)
ylabel('X_{ex}(nM)','FontName','Helvetica','FontSize',10,'FontWeight','bold')
ylim([0 12])

set(gca,'xticklabel',{},'ytick',0:3:12)
set(gca,'FontName','Helvetica','FontSize',10,'FontWeight','bold','linewidth',1.2)
% title('(ii)','FontName','Helvetica','FontSize',15,'FontWeight','bold')

box off
axes('position',[0.419,0.06,0.173,0.194]);

plot(t/24,Cytokine(:,n),'color','r','linewidth',1.2)
hold on
plot(t/24,Cytokine(:,m),'color','b','linewidth',1.2)
ylabel('[Cytokines](nM)')
xlabel('day after infection','FontName','Helvetica','FontSize',10,'FontWeight','bold')
set(gca,'FontName','Helvetica','FontSize',10,'FontWeight','bold','linewidth',1.2)
% title('(iii)','FontName','Helvetica','FontSize',15,'FontWeight','bold')

box off
axes('position',[0.187,0.06,0.173,0.194]);

plot(t1/24,1+S_Inf_m,'color','r','linewidth',1.2)
hold on
plot(t1/24,1+S_Inf_as,'color','b','linewidth',1.2)
ylim([1 10^3])
xlabel('day after infection','FontName','Helvetica','FontSize',10,'FontWeight','bold')
ylabel('Infected rate (cells/h)','FontName','Helvetica','FontSize',10,'FontWeight','bold')
set(gca,'Yscale','log')
set(gca,'FontName','Helvetica','FontSize',10,'FontWeight','bold','linewidth',1.2)
% title('(iv)','FontName','Helvetica','FontSize',15,'FontWeight','bold')

box off
axes('position',[0.662,0.30,0.173,0.194]);

plot(t2/24,RNA(:,n),'color','r','linewidth',1.2)
hold on
plot(t2/24,RNA(:,m),'color','b','linewidth',1.2)
% xlabel('day after infection','FontName','Helvetica','FontSize',10,'FontWeight','bold')
ylabel('X_{in} (nM/cell)','FontName','Helvetica','FontSize',10,'FontWeight','bold')
ylim([0,25])
set(gca,'xticklabel',{})
set(gca,'FontName','Helvetica','FontSize',10,'FontWeight','bold','linewidth',1.2)
% title('(v)','FontName','Helvetica','FontSize',15,'FontWeight','bold')

box off

axes('position',[0.662,0.06,0.173,0.194]);

plot(t/24,TCells(:,n)/10^6,'color','r','linewidth',1.2)
hold on
plot(t/24,TCells(:,m)/10^6,'color','b','linewidth',1.2)

xlabel('day after infection','FontName','Helvetica','FontSize',10,'FontWeight','bold')
ylabel('[T_{effector}](\times10^6 cells/ml)','FontName','Helvetica','FontSize',10,'FontWeight','bold')

set(gca,'FontName','Helvetica','FontSize',10,'FontWeight','bold','linewidth',1.2)
% title('(vi)','FontName','Helvetica','FontSize',15,'FontWeight','bold')
box off




annotation(fig1,'textbox',...
    [0.106 0.947 0.0255 0.063],...
    'String','a',...
    'FontWeight','bold',...
    'FontSize',18,...
    'fontname','Helvetica',...
    'FitBoxToText','off',...
    'EdgeColor','none');
annotation(fig1,'textbox',...
    [0.476 0.947 0.0255 0.063],...
    'String','b',...
    'FontWeight','bold',...
    'fontname','Helvetica',...
    'FontSize',18,...
    'FitBoxToText','off',...
    'EdgeColor','none');
annotation(fig1,'textbox',...
    [0.106 0.493 0.0255 0.063],'String','c',...
    'FontWeight','bold',...
    'fontname','Helvetica',...
    'FontSize',18,...
    'FitBoxToText','off',...
    'EdgeColor','none');

annotation(fig1,'textbox',...
    [0.258891891891892 0.479 0.0325 0.063],...
    'String','( i )',...
    'fontname','Helvetica',...
    'FontSize',15,...
    'HorizontalAlignment','left',...
    'FontWeight','bold',...
    'FitBoxToText','off',...
    'EdgeColor','none');
annotation(fig1,'textbox',...
    [0.492648648648649 0.479 0.0325 0.063],...
    'String','(ii)',...
    'FontSize',15,...
    'fontname','Helvetica',...
    'HorizontalAlignment','left',...
    'FontWeight','bold',...
    'FitBoxToText','off',...
    'EdgeColor','none');
annotation(fig1,'textbox',...
    [0.733135135135136 0.479 0.0325,0.063],...
    'String','(iii)',...
    'FontSize',15,...
    'fontname','Helvetica',...
    'HorizontalAlignment','left',...
    'FontWeight','bold',...
    'FitBoxToText','off',...
    'EdgeColor','none');
annotation(fig1,'textbox',...
    [0.258891891891892 0.235444444444445 0.0325 0.0630000000000001],...
    'String','(iv)',...
    'FontSize',15,...
    'fontname','Helvetica',...
    'HorizontalAlignment','left',...
    'FontWeight','bold',...
    'FitBoxToText','off',...
    'EdgeColor','none');
annotation(fig1,'textbox',...
    [0.492648648648649 0.234333333333334 0.0325 0.0630000000000001],...
    'String','(v)',...
    'FontSize',15,...
    'fontname','Helvetica',...
    'HorizontalAlignment','left',...
    'FontWeight','bold',...
    'FitBoxToText','off',...
    'EdgeColor','none');
annotation(fig1,'textbox',...
    [0.733135135135136,0.236555555555556,0.0325,0.063],...
    'String','(vi)',...
    'fontname','Helvetica',...
    'HorizontalAlignment','left',...
    'FontWeight','bold',...
    'FontSize',15,...
    'FitBoxToText','off',...
    'EdgeColor','none');

exportfig(fig1,'Fig4.eps','color','cmyk','fontmode','scaled','fontsize',1);
