load('Dataset3.mat')
fig1=figure(1)
clf()
set(gcf,'position',[100,200,1080,540])

subplot(2,3,4)
A2=log10(IL2_Survivor);A1=log10(IL2_Death);
n1=size(A1);n2=size(A2);
P=[A1; A2];
X=datashift(1,A1');
X=datashift(1,A1');
plot(X(:,1),X(:,2),'.','markersize',12,'color',[0.97,0.46,0.36]);
hold on
X2=datashift(2,A2');
plot(X2(:,1),X2(:,2),'s','markersize',5,'Markerfacecolor',[0.05,0.36,0.56],'MarkerEdgecolor',[0.05,0.36,0.56]);

g1=repmat({'Death'},[n1,1]);
g2=repmat({'Survivor'},[n2,1]);
g=[g1;g2];
h=boxplot(P,g,'Symbol','w','Widths',0.75);
set(h,'LineWidth',1.2)
set(h(:,1),'color',[0.97,0.46,0.36])
set(h(:,2),'color',[0.05,0.36,0.56])
ylim([0,1.5])
ylabel('log_{10} pg ml^{-1}')
set(gca,'linewidth',1.2,'FontSize',10,'FontWeight','bold','ytick',...
    0:0.5:3)
% title('IL-2','FontWeight','bold','FontSize',10)
annotation(fig1,'textbox',...
    [0.214333333333333 0.328888888888892 0.053814814814815 0.0503703703703708],...
    'String',{'P=0.097'},...
    'FontWeight','bold',...
    'FitBoxToText','off',...
    'EdgeColor','none');
annotation(fig1,'line',[0.217777777777779 0.271851851851854],...
    [0.333814814814817 0.333333333333335],'LineWidth',1.2);
box off

subplot(2,3,5)
A2=log10(IL4_Survivor);A1=log10(IL4_Death);
n1=size(A1);n2=size(A2);
P=[A1; A2];
X=datashift(1,A1');
X=datashift(1,A1');
plot(X(:,1),X(:,2),'.','markersize',12,'color',[0.97,0.46,0.36]);
hold on
X2=datashift(2,A2');
plot(X2(:,1),X2(:,2),'s','markersize',5,'Markerfacecolor',[0.05,0.36,0.56],'MarkerEdgecolor',[0.05,0.36,0.56]);

g1=repmat({'Death'},[n1,1]);
g2=repmat({'Survivor'},[n2,1]);
g=[g1;g2];
h=boxplot(P,g,'Symbol','w','Widths',0.75);
set(h,'LineWidth',1.2)
set(h(:,1),'color',[0.97,0.46,0.36])
set(h(:,2),'color',[0.05,0.36,0.56])
ylim([0,1.5])
%ylabel('log_{10} pg ml^{-1}')
set(gca,'linewidth',1.2,'FontSize',10,'FontWeight','bold','ytick',...
    0:0.5:1.5)
% title('IL-4','FontWeight','bold','FontSize',10)
annotation(fig1,'line',[0.487407407407409 0.540000000000003],...
    [0.283444444444448 0.282962962962966],'LineWidth',1.2);
annotation(fig1,'textbox',...
    [0.479259259259261 0.285925925925929 0.0681481481481482 0.0474074074074081],...
    'String','P=0.0057',...
    'FontWeight','bold',...
    'FitBoxToText','off',...
    'EdgeColor','none');
box off

subplot(2,3,6)
A2=log10(TNF_Survivor);A1=log10(TNF_Death);
n1=size(A1);n2=size(A2);
P=[A1; A2];
X=datashift(1,A1');
X=datashift(1,A1');
plot(X(:,1),X(:,2),'.','markersize',12,'color',[0.97,0.46,0.36]);
hold on
X2=datashift(2,A2');
plot(X2(:,1),X2(:,2),'s','markersize',5,'Markerfacecolor',[0.05,0.36,0.56],'MarkerEdgecolor',[0.05,0.36,0.56]);

g1=repmat({'Death'},[n1,1]);
g2=repmat({'Survivor'},[n2,1]);
g=[g1;g2];
h=boxplot(P,g,'Symbol','w','Widths',0.75);
set(h,'LineWidth',1.2)
set(h(:,1),'color',[0.97,0.46,0.36])
set(h(:,2),'color',[0.05,0.36,0.56])
ylim([0,3])
%ylabel('log_{10} pg ml^{-1}')
set(gca,'linewidth',1.2,'FontSize',10,'FontWeight','bold','ytick',...
    0:1:3)
% title('TNF-\alpha','FontWeight','bold','FontSize',10)
annotation(fig1,'line',[0.764444444444447 0.826666666666669],...
    [0.340740740740746 0.340740740740746],'LineWidth',1.2);
annotation(fig1,'textbox',...
    [0.771370370370375 0.342222222222227 0.0493703703703703 0.0459259259259261],...
    'String','P=0.90',...
    'FontWeight','bold',...
    'FitBoxToText','off',...
    'EdgeColor','none');
box off

load('Dataset4.mat')
subplot(2,3,1)
A0=IL2_HCW;A1=IL2_Moderate;A2=IL2_Severe;
n0=size(A0);n1=size(A1);n2=size(A2);
P=[A0;A1;A2];
X0=datashift(1,A0');
plot(X0(:,1),X0(:,2),'^','markersize',2.5,'Markerfacecolor',[0.89,0.40,0.13],'MarkerEdgecolor',[0.89,0.40,0.13]);
hold on
X1=datashift(2,A1');
plot(X1(:,1),X1(:,2),'.','markersize',12,'color',[0.35,0.10,0.71]);
hold on
X2=datashift(3,A2');
plot(X2(:,1),X2(:,2),'s','markersize',5,'Markerfacecolor',[0.13,0.55,0.61],'MarkerEdgecolor',[0.13,0.55,0.61]);

g2=repmat({'Severe'},[n2,1]);
g1=repmat({'Moderate'},[n1,1]);
g0=repmat({'HCW'},[n0,1])
g=[g0;g1;g2];
h=boxplot(P,g,'Symbol','w','Widths',0.75);
set(h,'LineWidth',1.2)
set(h(:,1),'color',[0.89,0.40,0.13])
set(h(:,2),'color',[0.35,0.10,0.71])
set(h(:,3),'color',[0.13,0.55,0.61])
ylim([-2.5,4])
ylabel('log_{10}pg ml^{-1}')
set(gca,'linewidth',1.2,'FontSize',10,'FontWeight','bold','ytick',...
    -2:2:4)
title('IL-2','FontWeight','bold','FontSize',10)
annotation(fig1,'textbox',...
    [0.189333333333333 0.832962962962964 0.0486296296296295 0.037037037037038],...
    'String','P=0.88',...
    'FontWeight','bold',...
    'FitBoxToText','off',...
    'EdgeColor','none');
annotation(fig1,'line',[0.193518518518519 0.236481481481481],...
    [0.831481481481481 0.83],'LineWidth',1.2);
annotation(fig1,'textbox',...
    [0.244888888888889 0.827037037037037 0.0819629629629629 0.0488888888888896],...
    'String','P=0.0016',...
    'FontWeight','bold',...
    'FitBoxToText','off',...
    'EdgeColor','none');
annotation(fig1,'line',[0.257962962962963 0.298703703703704],...
    [0.830481481481481 0.83],'LineWidth',1.2);
annotation(fig1,'textbox',...
    [0.219518518518519 0.880000000000001 0.0560370370370369 0.0355555555555559],...
    'String',{'P=0.011'},...
    'FontWeight','bold',...
    'FitBoxToText','off',...
    'EdgeColor','none');
annotation(fig1,'line',[0.195740740740741 0.297222222222222],...
    [0.873444444444445 0.871481481481482],'LineWidth',1.2);
box off

subplot(2,3,2)
A0=IL4_HCW;A1=IL4_Moderate;A2=IL4_Severe;
n0=size(A0);n1=size(A1);n2=size(A2);
P=[A0;A1;A2];
X0=datashift(1,A0');
plot(X0(:,1),X0(:,2),'^','markersize',2.5,'Markerfacecolor',[0.89,0.40,0.13],'MarkerEdgecolor',[0.89,0.40,0.13]);
hold on
X1=datashift(2,A1');
plot(X1(:,1),X1(:,2),'.','markersize',12,'color',[0.35,0.10,0.71]);
hold on
X2=datashift(3,A2');
plot(X2(:,1),X2(:,2),'s','markersize',5,'Markerfacecolor',[0.13,0.55,0.61],'MarkerEdgecolor',[0.13,0.55,0.61]);

g2=repmat({'Severe'},[n2,1]);
g1=repmat({'Moderate'},[n1,1]);
g0=repmat({'HCW'},[n0,1])
g=[g0;g1;g2];
h=boxplot(P,g,'Symbol','w','Widths',0.75);
set(h,'LineWidth',1.2)
set(h(:,1),'color',[0.89,0.40,0.13])
set(h(:,2),'color',[0.35,0.10,0.71])
set(h(:,3),'color',[0.13,0.55,0.61])
ylim([-2.5,4])
%ylabel('log_{10}pg ml^{-1}')
set(gca,'linewidth',1.2,'FontSize',10,'FontWeight','bold','ytick',...
    -2:2:4)
title('IL-4','FontWeight','bold','FontSize',10)
annotation(fig1,'line',[0.464444444444444 0.511111111111111],...
    [0.831592592592593 0.831111111111112],'LineWidth',1.2);
annotation(fig1,'textbox',...
    [0.461000000000002 0.831111111111113 0.0501111111111109 0.0370370370370374],...
    'String','P=0.89',...
    'FontWeight','bold',...
    'FitBoxToText','off',...
    'EdgeColor','none');
annotation(fig1,'line',[0.533333333333334 0.574814814814815],...
    [0.852333333333334 0.851851851851852],'LineWidth',1.2);
annotation(fig1,'textbox',...
    [0.527666666666667 0.860740740740742 0.050111111111111 0.0311111111111119],...
    'String','P=0.97',...
    'FontWeight','bold',...
    'FitBoxToText','off',...
    'EdgeColor','none');
annotation(fig1,'line',[0.479259259259259 0.568148148148148],...
    [0.887888888888889 0.885925925925926],'LineWidth',1.2);
annotation(fig1,'textbox',...
    [0.501740740740742 0.890370370370371 0.0486296296296297 0.0355555555555556],...
    'String','P=0.93',...
    'FontWeight','bold',...
    'FitBoxToText','off',...
    'EdgeColor','none');
box off

subplot(2,3,3)
A0=TNF_HCW;A1=TNF_Moderate;A2=TNF_Severe;
n0=size(A0);n1=size(A1);n2=size(A2);
P=[A0;A1;A2];
X0=datashift(1,A0');
plot(X0(:,1),X0(:,2),'^','markersize',2.5,'Markerfacecolor',[0.89,0.40,0.13],'MarkerEdgecolor',[0.89,0.40,0.13]);
hold on
X1=datashift(2,A1');
plot(X1(:,1),X1(:,2),'.','markersize',12,'color',[0.35,0.10,0.71]);
hold on
X2=datashift(3,A2');
plot(X2(:,1),X2(:,2),'s','markersize',5,'Markerfacecolor',[0.13,0.55,0.61],'MarkerEdgecolor',[0.13,0.55,0.61]);

g2=repmat({'Severe'},[n2,1]);
g1=repmat({'Moderate'},[n1,1]);
g0=repmat({'HCW'},[n0,1])
g=[g0;g1;g2];
h=boxplot(P,g,'Symbol','w','Widths',0.75);
set(h,'LineWidth',1.2)
set(h(:,1),'color',[0.89,0.40,0.13])
set(h(:,2),'color',[0.35,0.10,0.71])
set(h(:,3),'color',[0.13,0.55,0.61])
ylim([0,6])
%ylabel('log_{10}pg ml^{-1}')
set(gca,'linewidth',1.2,'FontSize',10,'FontWeight','bold','ytick',...
    0:2:6)
title('TNF-\alpha','FontWeight','bold','FontSize',10)
annotation(fig1,'line',[0.737222222222225 0.784629629629632],...
    [0.79777777777778 0.79777777777778],'LineWidth',1.2);
annotation(fig1,'textbox',...
    [0.720185185185187 0.806296296296298 0.0851851851851853 0.0477777777777784],...
    'String','P=1.15\times10^{-4}',...
    'FontWeight','bold',...
    'FitBoxToText','off',...
    'EdgeColor','none');
annotation(fig1,'line',[0.815000000000003 0.85203703703704],...
    [0.799259259259261 0.799259259259261],'LineWidth',1.2);
annotation(fig1,'textbox',...
    [0.809333333333337 0.803333333333336 0.050111111111111 0.0433333333333353],...
    'String','P=0.20',...
    'FontWeight','bold',...
    'FitBoxToText','off',...
    'EdgeColor','none');
annotation(fig1,'line',[0.744629629629632 0.846111111111114],...
    [0.850111111111114 0.848148148148151],'LineWidth',1.2);
annotation(fig1,'textbox',...
    [0.756740740740743 0.849259259259262 0.081222222222222 0.0537037037037041],...
    'String','P=6.21\times10^{-4}',...
    'FontWeight','bold',...
    'FitBoxToText','off',...
    'EdgeColor','none');

box off

annotation(fig1,'textbox',...
    [0.0678 0.873 0.0249 0.0667],...
    'String',{'a'},...
    'FontWeight','bold',...
    'FontSize',18,...
    'FitBoxToText','off',...
    'EdgeColor','none');
annotation(fig1,'textbox',...
    [0.354 0.874 0.0249 0.0667],...
    'String',{'b'},...
    'FontWeight','bold',...
    'FontSize',18,...
    'FitBoxToText','off',...
    'EdgeColor','none');
annotation(fig1,'textbox',...
    [0.633 0.874 0.0249 0.0667],...
    'String',{'c'},...
    'FontWeight','bold',...
    'FontSize',18,...
    'FitBoxToText','off',...
    'EdgeColor','none');
annotation(fig1,'textbox',...
    [0.0678 0.408 0.0249 0.0667],...
    'String',{'d'},...
    'FontWeight','bold',...
    'FontSize',18,...
    'FitBoxToText','off',...
    'EdgeColor','none');
annotation(fig1,'textbox',...
    [0.354 0.408 0.0249 0.0667],...
    'String',{'e'},...
    'FontWeight','bold',...
    'FontSize',18,...
    'FitBoxToText','off',...
    'EdgeColor','none');
annotation(fig1,'textbox',...
    [0.633 0.408 0.0249 0.0667],...
    'String',{'f'},...
    'FontWeight','bold',...
    'FontSize',18,...
    'FitBoxToText','off',...
    'EdgeColor','none');
exportfig(fig1,'Supfig2.eps','color','cmyk','fontmode','scaled','fontsize',1);

function X=datashift(k,U)
n=size(U,2);
X=zeros(n,2);
for i=1:n
    X(i,1) = k + 0.5*(rand()-0.5);
    X(i,2) = U(i);
end
end